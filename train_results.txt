python train_apollo.py --h5_path ../data_wav --output_dir ./apollo_training
Using device: cuda
Loaded 12795 train file pairs from directory
Loaded 3199 val file pairs from directory
Input size: 132300
Starting training for 50 epochs...

Epoch 1/50
Training:  16%|██████████████▎                                                                         | 521/3199 [01:07<04:44,  9.41it/s]Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:33<00:00,  7.06it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:12<00:00, 11.01it/s]
Train Loss: 0.045218, Val Loss: 0.048914
New best model saved! Val Loss: 0.048914

Epoch 2/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:39<00:00,  6.96it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:02<00:00, 12.79it/s]
Train Loss: 0.045163, Val Loss: 0.048906
New best model saved! Val Loss: 0.048906

Epoch 3/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:07<00:00,  7.49it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:48<00:00, 16.43it/s]
Train Loss: 0.045163, Val Loss: 0.048904
New best model saved! Val Loss: 0.048904

Epoch 4/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:20<00:00,  7.27it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:07<00:00, 11.85it/s]
Train Loss: 0.045160, Val Loss: 0.048911

Epoch 5/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:23<00:00,  7.21it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:58<00:00, 13.60it/s]
Train Loss: 0.045163, Val Loss: 0.048910

Epoch 6/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:49<00:00,  6.82it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:07<00:00, 11.93it/s]
Train Loss: 0.045158, Val Loss: 0.048898
New best model saved! Val Loss: 0.048898

Epoch 7/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:23<00:00,  7.21it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:08<00:00, 11.69it/s]
Train Loss: 0.045161, Val Loss: 0.048905

Epoch 8/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:11<00:00,  7.42it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:59<00:00, 13.52it/s]
Train Loss: 0.045159, Val Loss: 0.048898
New best model saved! Val Loss: 0.048898

Epoch 9/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:59<00:00,  7.63it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:55<00:00, 14.54it/s]
Train Loss: 0.045155, Val Loss: 0.048899

Epoch 10/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:58<00:00,  7.64it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:59<00:00, 13.43it/s]
Train Loss: 0.045159, Val Loss: 0.048898
New best model saved! Val Loss: 0.048898

Epoch 11/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:53<00:00,  7.74it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:01<00:00, 12.93it/s]
Train Loss: 0.045154, Val Loss: 0.048893
New best model saved! Val Loss: 0.048893

Epoch 12/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:51<00:00,  7.77it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:00<00:00, 13.26it/s]
Train Loss: 0.045150, Val Loss: 0.048895

Epoch 13/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:00<00:00,  7.60it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:00<00:00, 13.26it/s]
Train Loss: 0.045151, Val Loss: 0.048898

Epoch 14/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:10<00:00,  7.43it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:00<00:00, 13.19it/s]
Train Loss: 0.045159, Val Loss: 0.048898

Epoch 15/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:00<00:00,  7.60it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:55<00:00, 14.52it/s]
Train Loss: 0.045155, Val Loss: 0.048892
New best model saved! Val Loss: 0.048892

Epoch 16/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [07:00<00:00,  7.60it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:00<00:00, 13.15it/s]
Train Loss: 0.045149, Val Loss: 0.048893

Epoch 17/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:55<00:00,  7.69it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:00<00:00, 13.20it/s]
Train Loss: 0.045147, Val Loss: 0.048896

Epoch 18/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:46<00:00,  7.87it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:53<00:00, 15.02it/s]
Train Loss: 0.045148, Val Loss: 0.048890
New best model saved! Val Loss: 0.048890

Epoch 19/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:26<00:00,  8.29it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:52<00:00, 15.12it/s]
Train Loss: 0.045146, Val Loss: 0.048889
New best model saved! Val Loss: 0.048889

Epoch 20/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:19<00:00,  8.42it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.68it/s]
Train Loss: 0.045148, Val Loss: 0.048899

Epoch 21/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:42<00:00,  7.95it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:53<00:00, 14.82it/s]
Train Loss: 0.045156, Val Loss: 0.048884
New best model saved! Val Loss: 0.048884

Epoch 22/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:40<00:00,  7.99it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:59<00:00, 13.45it/s]
Train Loss: 0.045143, Val Loss: 0.048887

Epoch 23/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:43<00:00,  7.92it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:54<00:00, 14.70it/s]
Train Loss: 0.045143, Val Loss: 0.048882
New best model saved! Val Loss: 0.048882

Epoch 24/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:27<00:00,  8.26it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [01:01<00:00, 13.06it/s]
Train Loss: 0.045143, Val Loss: 0.048886

Epoch 25/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:27<00:00,  8.25it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.90it/s]
Train Loss: 0.045142, Val Loss: 0.048886

Epoch 26/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:17<00:00,  8.48it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:57<00:00, 13.86it/s]
Train Loss: 0.045140, Val Loss: 0.048883

Epoch 27/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:04<00:00,  8.78it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:53<00:00, 14.98it/s]
Train Loss: 0.045143, Val Loss: 0.048881
New best model saved! Val Loss: 0.048881

Epoch 28/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:11<00:00,  8.61it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.90it/s]
Train Loss: 0.045143, Val Loss: 0.048884

Epoch 29/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:04<00:00,  8.77it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:59<00:00, 13.46it/s]
Train Loss: 0.045140, Val Loss: 0.048884

Epoch 30/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:01<00:00,  8.84it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:54<00:00, 14.61it/s]
Train Loss: 0.045142, Val Loss: 0.048883

Epoch 31/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:01<00:00,  8.85it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:59<00:00, 13.38it/s]
Train Loss: 0.045138, Val Loss: 0.048880
New best model saved! Val Loss: 0.048880

Epoch 32/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:18<00:00,  8.45it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:53<00:00, 15.04it/s]
Train Loss: 0.045140, Val Loss: 0.048879
New best model saved! Val Loss: 0.048879

Epoch 33/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:58<00:00,  8.92it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.72it/s]
Train Loss: 0.045136, Val Loss: 0.048876
New best model saved! Val Loss: 0.048876

Epoch 34/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:04<00:00,  8.77it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:53<00:00, 15.09it/s]
Train Loss: 0.045138, Val Loss: 0.048881

Epoch 35/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:02<00:00,  8.83it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:48<00:00, 16.65it/s]
Train Loss: 0.045138, Val Loss: 0.048881

Epoch 36/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:06<00:00,  8.74it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.79it/s]
Train Loss: 0.045137, Val Loss: 0.048876

Epoch 37/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:02<00:00,  8.84it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:54<00:00, 14.69it/s]
Train Loss: 0.045135, Val Loss: 0.048880

Epoch 38/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:57<00:00,  8.94it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:52<00:00, 15.25it/s]
Train Loss: 0.045134, Val Loss: 0.048879

Epoch 39/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:54<00:00,  9.01it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.94it/s]
Train Loss: 0.045138, Val Loss: 0.048879

Epoch 40/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:59<00:00,  8.90it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.84it/s]
Train Loss: 0.045134, Val Loss: 0.048879

Epoch 41/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [06:03<00:00,  8.80it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:52<00:00, 15.13it/s]
Train Loss: 0.045133, Val Loss: 0.048876
New best model saved! Val Loss: 0.048876

Epoch 42/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:55<00:00,  9.01it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.82it/s]
Train Loss: 0.045135, Val Loss: 0.048875
New best model saved! Val Loss: 0.048875

Epoch 43/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:54<00:00,  9.03it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.91it/s]
Train Loss: 0.045134, Val Loss: 0.048872
New best model saved! Val Loss: 0.048872

Epoch 44/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:49<00:00,  9.15it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.88it/s]
Train Loss: 0.045132, Val Loss: 0.048874

Epoch 45/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:53<00:00,  9.04it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.93it/s]
Train Loss: 0.045130, Val Loss: 0.048874

Epoch 46/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:51<00:00,  9.10it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:53<00:00, 14.83it/s]
Train Loss: 0.045132, Val Loss: 0.048873

Epoch 47/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:49<00:00,  9.15it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.71it/s]
Train Loss: 0.045133, Val Loss: 0.048874

Epoch 48/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:51<00:00,  9.11it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:52<00:00, 15.12it/s]
Train Loss: 0.045130, Val Loss: 0.048876

Epoch 49/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:50<00:00,  9.14it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.93it/s]
Train Loss: 0.045130, Val Loss: 0.048874

Epoch 50/50
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3199/3199 [05:48<00:00,  9.17it/s]
Validation: 100%|███████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:47<00:00, 16.95it/s]
Train Loss: 0.045132, Val Loss: 0.048874

Training completed!
Best validation loss: 0.048872
Model saved to: ./apollo_training